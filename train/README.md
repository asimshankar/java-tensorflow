# Training [TensorFlow](https://www.tensorflow.org) models in Java

Python is the primary language in which TensorFlow models are typically
developed and trained. TensorFlow does have [bindings for other programming
languages](https://www.tensorflow.org/api_docs/). These bindings have the
low-level primitives that are required to build a more complete API, however,
lack much of the higher-level API richness of the Python bindings, particularly
for defining the model structure.

This file demonstrates taking a model (a TensorFlow graph) created by a Python
program and running the training loop in Java (and saving the trained weights
to disk).

## The model

The model is a trivial one, trying to learn the function: `f(x) = W\*x + b`,
where `W` and `b` are model parameters. The training data is constructed so that
the "true" value of `W` is 3 and that of `b` is 2, i.e., `f(x) = 3 * x + 2`.

Thus, over time, the predicted value for an input of 1, 2, and 3 should tend
towards 5, 8, and 11.

## Quickstart

1.  Run the training loop program in Java using:

    ```
    mvn compile exec:java -q -Dexec.args="graph.pb /tmp/checkpoint"
    ```

    Where `graph.pb` is the serialized TenosrFlow graph  and `/tmp/checkpoint`
    is the directory from which trained weights (the checkpoint) should be
    loaded (if available) and saved to (after training).

## Generating the graph

The `graph.pb` file which contains the model definition, and the names of the
tensors in it were generated by running `python model.py`.


## Noteworthy

-   The Python APIs for TensorFlow include other conveniences for training (such
    as `MonitoredSession` and `tf.train.Estimator`), which make it easier to
    configure checkpointing, evaluation loops etc. The examples here aren't that
    sophisticated and are focused on basic model training only.
-   In this example, we use placeholders and feed dictionaries to feed input,
    but you probably want to use the
    [`tf.data`](https://www.tensorflow.org/programmers_guide/datasets) API to
    cconstruct an input pipeline for providing training data to the model.
-   Not demonstrated here, but summaries for TensorBoard can also be produced by
    executing the summary operations.
